<?xml version="1.0" encoding="utf-8"?><?workdir /C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\temp\temp20190509171902990\Trident\device\devspec\switch_management?><?workdir-uri file:/C:/Git/XDocs-DITA-OT-185/XDocs-DITA-OT-185/DITA-OT1.8.5/temp/temp20190509171902990/Trident/device/devspec/switch_management/?><?path2project ..\?><?path2project-uri ../?><topic xmlns:ditaarch="http://dita.oasis-open.org/architecture/2005/" ditaarch:DITAArchVersion="1.2" class="- topic/topic " xml:lang="en-US" id="Using_PCIe_Utility_for_Flashing_Firmware_tib2hkzeo" domains="(topic hi-d)                             (topic ut-d)                             (topic indexing-d)                            (topic hazard-d)                            (topic abbrev-d)                            (topic pr-d)                             (topic sw-d)                            (topic ui-d)                            (topic struct-d)                            (topic firmware-d)                            (topic pmcrevhis-d)   " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\switch_management\trident_switch_mgmnt_pcie_update_firmware.xml" xtrc="topic:1;9:468">
   <title class="- topic/title " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\switch_management\trident_switch_mgmnt_pcie_update_firmware.xml" xtrc="title:1;12:26">Using the Linux Utility to Update Firmware</title>
   <body class="- topic/body " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\switch_management\trident_switch_mgmnt_pcie_update_firmware.xml" xtrc="body:1;15:123">
      <p class="- topic/p " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\switch_management\trident_switch_mgmnt_pcie_update_firmware.xml" xtrc="p:1;18:123">Switchtec FW can be updated in-band using the ‘switchtec.ko’ driver and the Switchtec user space utility's "fw_update" command. The following steps are required <ph status="deleted" rev="deltaxml-delete" class="- topic/ph " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\switch_management\trident_switch_mgmnt_pcie_update_firmware.xml" xtrc="ph:1;18:327">to allow </ph>for in-band FW updates:</p>
      <p class="- topic/p " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\switch_management\trident_switch_mgmnt_pcie_update_firmware.xml" xtrc="p:2;21:123">1. Configure the <ph status="deleted" rev="deltaxml-delete" class="- topic/ph " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\switch_management\trident_switch_mgmnt_pcie_update_firmware.xml" xtrc="ph:2;21:183">switch</ph>
         <ph status="new" rev="deltaxml-add" class="- topic/ph " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\switch_management\trident_switch_mgmnt_pcie_update_firmware.xml" xtrc="ph:3;22:46">switchtec</ph> USP connected to the host to <i class="+ topic/ph hi-d/i " status="unchanged" xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\switch_management\trident_switch_mgmnt_pcie_update_firmware.xml" xtrc="i:1;25:32">USP with Management EP</i>
         <i pmc_switch="Encl_mgmt Fanout Fanout-L Fanout-LI" class="+ topic/ph hi-d/i " status="unchanged" xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\switch_management\trident_switch_mgmnt_pcie_update_firmware.xml" xtrc="i:2;30:32"> or USP with NT EP</i>
      </p>
      <p class="- topic/p " status="unchanged" xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\switch_management\trident_switch_mgmnt_pcie_update_firmware.xml" xtrc="p:3;35:29">2. Download the Switchtec Software Tools package for Switchtec.</p>
      <p class="- topic/p " status="unchanged" xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\switch_management\trident_switch_mgmnt_pcie_update_firmware.xml" xtrc="p:4;39:29">3. Install the Switchtec driver and Switchtec utilities within package. Please refer to the README in the package for installation instructions.</p>
      <p class="- topic/p " status="unchanged" xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\switch_management\trident_switch_mgmnt_pcie_update_firmware.xml" xtrc="p:5;43:29">4. Load the Switchtec driver:</p>
      <p class="- topic/p " status="unchanged" xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\switch_management\trident_switch_mgmnt_pcie_update_firmware.xml" xtrc="p:6;47:29">E.g. <filepath class="+ topic/ph sw-d/filepath " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\switch_management\trident_switch_mgmnt_pcie_update_firmware.xml" xtrc="filepath:1;49:38">$&gt; modprobe switchtec</filepath>
      </p>
      <p class="- topic/p " status="unchanged" xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\switch_management\trident_switch_mgmnt_pcie_update_firmware.xml" xtrc="p:7;54:29">5. Use the firmware download command to flash the image:</p>
      <p class="- topic/p " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\switch_management\trident_switch_mgmnt_pcie_update_firmware.xml" xtrc="p:8;57:123">E.g.<filepath class="+ topic/ph sw-d/filepath " status="changed" xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\switch_management\trident_switch_mgmnt_pcie_update_firmware.xml" xtrc="filepath:2;60:37"> $&gt;sudo ./switchtec fw-update +[[-A ]]+/dev/switchtec0 switchtec_psx.pmc</filepath>
      </p>
      <note class="- topic/note " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\switch_management\trident_switch_mgmnt_pcie_update_firmware.xml" xtrc="note:1;64:126">Downloading firmware using <ph status="deleted" rev="deltaxml-delete" class="- topic/ph " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\switch_management\trident_switch_mgmnt_pcie_update_firmware.xml" xtrc="ph:4;64:196">this command will</ph>
         <ph status="new" rev="deltaxml-add" class="- topic/ph " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\switch_management\trident_switch_mgmnt_pcie_update_firmware.xml" xtrc="ph:5;65:46">"-A" option will NOT</ph> automatically toggle the partition pointer so that on the next reboot, the newly flashed image will <ph status="new" rev="deltaxml-add" class="- topic/ph " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\switch_management\trident_switch_mgmnt_pcie_update_firmware.xml" xtrc="ph:6;65:208">NOT </ph>run.</note>
      <p class="- topic/p " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\switch_management\trident_switch_mgmnt_pcie_update_firmware.xml" xtrc="p:9;68:123">6. <ph status="deleted" rev="deltaxml-delete" class="- topic/ph " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\switch_management\trident_switch_mgmnt_pcie_update_firmware.xml" xtrc="ph:7;68:169">(Optional) </ph>The following command can be used to toggle the active partition pointer:</p>
      <p class="- topic/p " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\switch_management\trident_switch_mgmnt_pcie_update_firmware.xml" xtrc="p:10;71:123">E.g. <filepath class="+ topic/ph sw-d/filepath " status="changed" xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\switch_management\trident_switch_mgmnt_pcie_update_firmware.xml" xtrc="filepath:3;74:37">$&gt;sudo ./switchtec fw-toggle /dev/switchtec0 &lt; -c | -f | --[[t | -]]-b&gt;</filepath>
      </p>
      <p class="- topic/p " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\switch_management\trident_switch_mgmnt_pcie_update_firmware.xml" xtrc="p:11;78:123">The input arguments "-c" toggle the data partition (configuration file), "-f" toggle the image partition (main FW), "-<ph status="deleted" rev="deltaxml-delete" class="- topic/ph " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\switch_management\trident_switch_mgmnt_pcie_update_firmware.xml" xtrc="ph:8;78:284">t" toggle the data partition(configuration file), and the image partition (main FW) at the same time; "-</ph>b" toggle BL2.</p>
      <note class="- topic/note " rev="deltaxml-add" status="new" xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\switch_management\trident_switch_mgmnt_pcie_update_firmware.xml" xtrc="note:2;83:26">
         <p class="- topic/p " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\switch_management\trident_switch_mgmnt_pcie_update_firmware.xml" xtrc="p:12;86:25">The following is download sequence for different cases:</p>
         <ol class="- topic/ol " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\switch_management\trident_switch_mgmnt_pcie_update_firmware.xml" xtrc="ol:1;89:26">
            <li class="- topic/li " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\switch_management\trident_switch_mgmnt_pcie_update_firmware.xml" xtrc="li:1;92:29">
               <p class="- topic/p " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\switch_management\trident_switch_mgmnt_pcie_update_firmware.xml" xtrc="p:13;95:31"> If just download one image: configuration file image</p>
               <p class="- topic/p " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\switch_management\trident_switch_mgmnt_pcie_update_firmware.xml" xtrc="p:14;98:31">Issue the command <i class="+ topic/ph hi-d/i " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\switch_management\trident_switch_mgmnt_pcie_update_firmware.xml" xtrc="i:3;100:33">sudo ./switchtec fw-update -A</i> to update configuration file image as the above description;</p>
               <p class="- topic/p " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\switch_management\trident_switch_mgmnt_pcie_update_firmware.xml" xtrc="p:15;103:31">Then issue the command <i class="+ topic/ph hi-d/i " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\switch_management\trident_switch_mgmnt_pcie_update_firmware.xml" xtrc="i:4;105:33">sudo ./switchtec fw-toggle -c </i> to activate the new configuration image;</p>
            </li>
            <li class="- topic/li " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\switch_management\trident_switch_mgmnt_pcie_update_firmware.xml" xtrc="li:2;109:29">
               <p class="- topic/p " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\switch_management\trident_switch_mgmnt_pcie_update_firmware.xml" xtrc="p:16;112:31"> If just download one image: main FW image</p>
               <p class="- topic/p " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\switch_management\trident_switch_mgmnt_pcie_update_firmware.xml" xtrc="p:17;115:31">In the CLI, issue the command <i class="+ topic/ph hi-d/i " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\switch_management\trident_switch_mgmnt_pcie_update_firmware.xml" xtrc="i:5;117:33">sudo ./switchtec fw-update -A</i> to update main FW image as the above description;</p>
               <p class="- topic/p " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\switch_management\trident_switch_mgmnt_pcie_update_firmware.xml" xtrc="p:18;120:31">Then issue the command <i class="+ topic/ph hi-d/i " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\switch_management\trident_switch_mgmnt_pcie_update_firmware.xml" xtrc="i:6;122:33">sudo ./switchtec fw-toggle -f </i> to activate the new main FW image;</p>
            </li>
            <li class="- topic/li " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\switch_management\trident_switch_mgmnt_pcie_update_firmware.xml" xtrc="li:3;126:29">
               <p class="- topic/p " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\switch_management\trident_switch_mgmnt_pcie_update_firmware.xml" xtrc="p:19;129:31"> If download two images: configuration file image and main FW image</p>
               <p class="- topic/p " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\switch_management\trident_switch_mgmnt_pcie_update_firmware.xml" xtrc="p:20;132:31">In the CLI, issue the command <i class="+ topic/ph hi-d/i " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\switch_management\trident_switch_mgmnt_pcie_update_firmware.xml" xtrc="i:7;134:33">sudo ./switchtec fw-update -A</i> to update configuration file image and main FW image separately as the above description;</p>
               <p class="- topic/p " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\switch_management\trident_switch_mgmnt_pcie_update_firmware.xml" xtrc="p:21;137:31">Then issue the command <i class="+ topic/ph hi-d/i " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\switch_management\trident_switch_mgmnt_pcie_update_firmware.xml" xtrc="i:8;139:33">sudo ./switchtec fw-toggle -c -f</i> to activate the new two images: configuration file image and main FW image;</p>
            </li>
         </ol>
      </note>
      <note class="- topic/note " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\switch_management\trident_switch_mgmnt_pcie_update_firmware.xml" xtrc="note:3;145:27">
         <p class="- topic/p " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\switch_management\trident_switch_mgmnt_pcie_update_firmware.xml" xtrc="p:22;148:25">In disaster recovery, if the inactive partitions were used to boot the FW, care needs to be taken to toggle the flags before a firmware download so that the correct images are written. In this case, if disaster recovery was used to boot the inactive image/inactive data partitions, then a toggle of both the image and data partitions should be performed PRIOR to downloading firmware.</p>
      </note>
   </body>
</topic>