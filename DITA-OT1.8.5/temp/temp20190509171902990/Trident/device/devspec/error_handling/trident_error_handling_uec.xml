<?xml version="1.0" encoding="utf-8"?><?workdir /C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\temp\temp20190509171902990\Trident\device\devspec\error_handling?><?workdir-uri file:/C:/Git/XDocs-DITA-OT-185/XDocs-DITA-OT-185/DITA-OT1.8.5/temp/temp20190509171902990/Trident/device/devspec/error_handling/?><?path2project ..\?><?path2project-uri ../?><topic xmlns:ditaarch="http://dita.oasis-open.org/architecture/2005/" ditaarch:DITAArchVersion="1.2" class="- topic/topic " xml:lang="en-US" base="base" id="trident_error_handling_uec" domains="(topic hi-d)                             (topic ut-d)                             (topic indexing-d)                            (topic hazard-d)                            (topic abbrev-d)                            (topic pr-d)                             (topic sw-d)                            (topic ui-d)                            (topic struct-d)                            (topic firmware-d)                            (topic pmcrevhis-d)   " status="unchanged" xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\error_handling\trident_error_handling_uec.xml" xtrc="topic:1;11:27">
   <title class="- topic/title " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\error_handling\trident_error_handling_uec.xml" xtrc="title:1;14:26">Upstream Error Containment</title>
   <body class="- topic/body " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\error_handling\trident_error_handling_uec.xml" xtrc="body:1;17:24">
      <note audience="PMCInternal" class="- topic/note " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\error_handling\trident_error_handling_uec.xml" xtrc="note:1;21:27">This content was sourced from Saratoga Device Specification Issue 12.00</note>
      <note class="- topic/note " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\error_handling\trident_error_handling_uec.xml" xtrc="note:2;24:27">
         <p class="- topic/p " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\error_handling\trident_error_handling_uec.xml" xtrc="p:1;27:24">
            <draft-comment author="C33308" time="Tue 03/26/2019 08:12 AM" translate="no" class="- topic/draft-comment " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\error_handling\trident_error_handling_uec.xml" xtrc="draft-comment:1;33:51">Remove in RevB</draft-comment>This feature is only available in the revision B switch</p>
      </note>
      <p class="- topic/p " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\error_handling\trident_error_handling_uec.xml" xtrc="p:2;37:21">Upstream Error Containment (UEC) is a flexible and programmable feature designed to protect errors from propagating upstream (towards the host). UEC is generally used on downstream ports. UEC can be triggered with the rules search tables (RST) based on any rule valid in the RST or by the TLP checker based on any number of uncorrectable errors and error messages. Unlike Downstream Port Containment (DPC), UEC does not bring down the port or discard any Transaction Layer Packet (TLP). Instead the error TLP is marked and the Switch Core (SC) buffer is temporarily stalled while the firmware edits the TLP and processes the event. The switch does not stall, but the affected path is stalled do to lack of PCIe credits. The ingress frame buffer in the switch core will back-pressure the affected port, while the other ports are able to continue their regular operation.</p>
      <p class="- topic/p " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\error_handling\trident_error_handling_uec.xml" xtrc="p:3;40:21">
         <xref href="#trident_error_handling_uec/fig_UEC_Triggering_an_Errored_TLP_0i3cbf5ow" class="- topic/xref " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\error_handling\trident_error_handling_uec.xml" xtrc="xref:1;44:30" type="fig"><?ditaot gentext?>Figure 1</xref> illustrates an errored TLP traversing the PSX and triggering the UEC mechanism. In this example the errored TLP causes the switch core to begin blocking further TLPs (data-path is halted) while the errored TLP is routed through the switch to the PPU. Stalling the flow of traffic from the ingress port allows the firmware to process the TLP and forward it without violating PCIe ordering rules. After processing the TLP, firmware opens the pipe to allow traffic to flow normally. Operation of the switch for subsequent TLPs that trigger UEC is identical.</p>
      <note audience="MSCCInternal" class="- topic/note " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\error_handling\trident_error_handling_uec.xml" xtrc="note:3;48:27">
         <p class="- topic/p " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\error_handling\trident_error_handling_uec.xml" xtrc="p:4;51:24">Source graphics: http://bby1dms01.pmc-sierra.internal/DocMgmt/fileinfo.cfm?file_id=437704</p>
      </note>
      <fig id="fig_UEC_Triggering_an_Errored_TLP_0i3cbf5ow" class="- topic/fig " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\error_handling\trident_error_handling_uec.xml" xtrc="fig:1;56:25">
         <title class="- topic/title " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\error_handling\trident_error_handling_uec.xml" xtrc="title:2;59:32">UEC Triggering an Errored TLP</title>
         <image href="graphics/trident_err_uec_block.svg" placement="inline" width="6in" class="- topic/image " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\error_handling\trident_error_handling_uec.xml" xtrc="image:1;65:33"/>
      </fig>
      <p class="- topic/p " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\error_handling\trident_error_handling_uec.xml" xtrc="p:5;69:21">The firmware running on the switch can be customized to implement an error handling routine, including for example:</p>
      <ul class="- topic/ul " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\error_handling\trident_error_handling_uec.xml" xtrc="ul:1;72:23">
         <li class="- topic/li " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\error_handling\trident_error_handling_uec.xml" xtrc="li:1;75:26">Drop an ERR_FATAL</li>
         <li class="- topic/li " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\error_handling\trident_error_handling_uec.xml" xtrc="li:2;78:26">Modify an ERR_FATAL to ERR_NONFATAL or ERR_COR</li>
         <li class="- topic/li " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\error_handling\trident_error_handling_uec.xml" xtrc="li:3;81:26">Drop an ERR_NONFATAL</li>
         <li class="- topic/li " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\error_handling\trident_error_handling_uec.xml" xtrc="li:4;84:26">Modify ERR_NONFATAL to ERR_COR</li>
         <li class="- topic/li " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\error_handling\trident_error_handling_uec.xml" xtrc="li:5;87:26">Drop an ERR_COR</li>
         <li class="- topic/li " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\error_handling\trident_error_handling_uec.xml" xtrc="li:6;90:26">Drop a Poisoned TLP and allow Completion Timeout Synthesis to generate all 1’s SC completion if it were a completion.</li>
         <li class="- topic/li " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\error_handling\trident_error_handling_uec.xml" xtrc="li:7;93:26">Drop a UR completion and allow Completion Timeout Synthesis to generate all 1’s SC completions for the outstanding data.</li>
         <li class="- topic/li " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\error_handling\trident_error_handling_uec.xml" xtrc="li:8;96:26">Drop a CA completion and allow Completion Timeout Synthesis to generate SC completions for the outstanding data.</li>
      </ul>
      <p class="- topic/p " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\error_handling\trident_error_handling_uec.xml" xtrc="p:6;100:21">This is not intended to be an exhaustive list of behavior but it captures some of the possible ways UEC can be used. FW writes to the SC to re-open the pipeline after processing of the UEC triggered TLP.</p>
      <p audience="PMCInternal" class="- topic/p " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\error_handling\trident_error_handling_uec.xml" xtrc="p:7;104:21">When UEC is enabled (applicable to a DS port only), a detected unmasked uncorrectable error or a fatal/non-fatal Message triggers the error TLP to be marked with a stall_sc_ifb flag and routed to the PCIe Processor Unit (PPU) with no Address or ID translation. The SC allows this error TLP to be routed to the PPU but stalls its IFB once the error TLP leaves it. FW is responsible to restart the SC’s IFB after it has processed the error TLP.</p>
      <p audience="PMCInternal" class="- topic/p " xtrf="C:\Git\XDocs-DITA-OT-185\XDocs-DITA-OT-185\DITA-OT1.8.5\samples\diffed\_b-0-file-\Trident\device\devspec\error_handling\trident_error_handling_uec.xml" xtrc="p:8;108:21">UEC-stalling mechanism is packet-based, which means that for a specific number of consecutive TLPs, some might be marked with “stall_sc_ifb” flag while others might not, as shown in the following figure.</p>
   </body>
</topic>